---
title: "Distribuição Kumaraswamy"
subtitle: E suas Aplicações
author: "Alisson Rosa, <br> Digite seu nome aqui!"
institute: "Universidade Federal de Santa Maria"
abstract: "Muitas vezes estamos interessados em modelar variáveis que estão definidas   entre zero e um,
como sabemos aonde nossa variável esta definida mas não sabemos qual dos valores será observado,
temos portanto uma incerteza probabilística, que pode e deve ser modelada por medidas de
 probabilidade. Aqui portanto, introduziremos a distribuição Kumaraswamy, que é uma
 das muitas possibilidades para modelagem desse tipo de variável, encontraremos estimativas 
 para os parâmetros da distribuição usando estimadores de máxima verossimilhança blah blah."
format: 
  pdf:
    include-in-header: 
      text: |
        \usepackage{float}
    number-sections: true
    keep-tex: true
    fig-width: 5.9
    fig-height: 2.9
    indent: 2m
    geometry:
      - top=20mm
      - left=18mm
      - right=18mm
      - heightrounded
    documentclass: article
      
execute:
  warning: false
  echo: false
lang: pt
bibliography: docs/bib.bib
nocite: |
          @*
---


\section{\centering Introdução}

Atualmente muitos fenômenos podem ser descritos como variáveis aleatórias (va) definidas no intervalo unitário (0,1) ^[Onde parenteses indica limites  do intervalo abertos.], assim é natural que pesquisadores desenvolvam distribuições de probabilidade que abarcam esse tipo de va. Uma dessas distribuições é a Kumaraswamy, que foi introduzida em @kuma como uma alternativa ao
modelo beta para aplicações na ́area de hidrologia. Em virtude deste fato, grande parte dos trabalhos
empíricos desta distribuição concentra-se nessa área @nadarajah2008distribution. O presente trabalho visa contribuir na expansão e utilização da Kumaraswamy, empregando modelos incondicionais para a taxa de desfloresmento em diversos munícipios da Amazônia legal, disponilizados (http://www.dpi.inpe.br/prodesdigital/prodesmunicipal.php)[aqui] pelo projeto PRODES do INPE. Assim é possível mensurar a qualidade da Kumaraswamy para modelagem dos dados propostos, para isso estamos utilizando 6 métricas frequentistas estabelecidas: AIC, BIC, CAIC, Kolmogorov-Smirnov, Cramer-Von Mises e Anderson-Darling, em contraste com a Distribuição Normal e a Distribuição Beta.

\section{\centering A distribuição Kumaraswamy}

Vamos nessa seção introduzir quantidades básicas da distribuição Kumaraswamy, sendo elas sua função densidade de probabilidade (pdf), função de distribuição acumulada (cdf), função quantilica (qf), função de verossimilhança (ll) e esperança (**E**)

\subsection{Quantidade Básicas}

Seja X uma variável aleatória que segue uma distribuição Kumaraswamy, então sua cdf é dada por:

\begin{align}
F(x;\alpha, \beta) = 1 - (1 - x^\alpha)^\beta,  \quad 0 < x< 1
\end{align}

Onde $\alpha, \beta > 0$. Sua pdf então fica definida como:

\begin{align}
f(x;\alpha, \beta) = \dfrac{dF}{dx} =\alpha\beta x^{\alpha - 1}(1 - x^\alpha)^{\beta  - 1}, \quad 0 < x< 1
\end{align}

Sua qf, que é  a função inversa da cdf, fica definida como:

\begin{align}
Q(u;\alpha, \beta) = \bigg(1 - (1 - u)^{1/\beta}\bigg)^{\dfrac{1}{\alpha}}, \quad 0<u<1
\end{align}

É FÁCIL ver que que a esperança da distribuição Kumaraswamy é dada por  

\begin{align}
\text{E}(X) = \dfrac{\beta\Gamma\bigg(1 + \dfrac{1}{\alpha}\bigg)\Gamma(\beta)}{\Gamma\bigg(1 + \dfrac{1}{\alpha} + \beta\bigg)}
\end{align}

A função de verossimilhança é dada por:

\begin{align}
L(\alpha, \beta; x) = \prod_{i=1}^{n}f(x;\alpha, \beta) = \alpha^n \beta^n \prod_{i=1}^{n}x_i^{\alpha - 1}\prod_{i=1}^{n}(1-x_i^{\alpha})^{\beta-1}
\end{align}

```{python}
from model.Kuma import Kuma
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
from model.utils import bar_ploto
import pandas as pd

```
```{python}
#| fig-cap: "Função densidade da  Kumaraswamy para alguns valores de parâmetros"
#| label: fig-plt
kuma = Kuma(0.5, 0.5)
prm={"figure.figsize":(8, 4),
'figure.dpi':150}
plt.rcParams.update(prm)
plt.rc('legend', fontsize=10)

def plot_density(alpha, beta):
  pass
x = np.random.uniform(0, 1, 5000)
sns.kdeplot(Kuma(0.5, 0.5).quantile(x))
sns.kdeplot(Kuma(2, 5).quantile(x))
sns.kdeplot(Kuma(1, 2).quantile(x))
plt.legend(title="Parâmetros", loc="upper right", labels=["$\\alpha = 0.5, \\beta = 0.5$","$\\alpha = 2, \\beta = 5$", "$\\alpha = 1, \\beta = 2$"]);
```
\subsection{Aplicações e Revisão Bibliográfica}

O artigo de @kuma propõe e demonstra aplicações da distribuição Kumaraswamy para variáveis 
aleatórias e processos aleatórios derivados de processos hidrológicos. O artigo foi publicado 
na *Journal of Hydrology*, assim é perceptível que a distribuição foi concebida para se adequar
a dados hidrológicos. Temos como casos de suas utilizações em precipitação diária, fluxo diário, 
reservatórios de água e análise das ondas do oceano, entre outras.

Para @nadarajah2008distribution a utilização da Kumaraswamy para o campo da hidrologia, é 
consolidada. Sendo perceptível pelas inúmeras aplicações em diversos artigos como: @sundar, 
@fletcher e @koutsoyiannis, além de se sobressair em relação a distribuição beta, a distribuição 
padrão para dados no (0,1), de acordo com @koutsoyiannis. Em @dey2018kumaraswamy a Kumaraswamy é 
utilizada para a quantidade de deslocamento de líquido metálico em duas máquinas diferentes, 
sendo superior as Distribuições Gumbel e Fréchet.

É notório também a dissiminação recente do estudo da Kumaraswamy, em expansão para distribuições 
mais complexas, como em @lemonte2013exponentiated, @mazucheli2020unit, @cribari2019inflated e 
@sagrillo2021modified ou em suas aplicações em regressão e séries temporais, visto em 
@pumi2020kumaraswamy, @mitnik2013kumaraswamy, @bayer2021inflated e @bayer2017kumaraswamy.



\section{\centering Análise Inicial}
blah blah

```{python}
df = pd.read_csv("data/desmatamento.prop.csv").drop(["Unnamed: 0"], axis=1)
df.rename(columns={"desmatamento_pro": "prop"}, inplace=True)
```

\subsection{Apresentação dos dados}

```{python}
#| fig-cap: "Proporção média dos Estados"
#| label: fig-states
bar_ploto(df)


```

\subsection{Medidas Básicas}


\section{\centering Ajuste do Modelo}
Para a verificação da adequação da distribuição Kumaraswamy para modelagem de dados de desmatamento
iremos realizar a comparação com duas distribuições amplamente utilizadas: Distribuição Normal e a 
Distribuição beta, a distribuição mais utilizada para variáveis aleatórias com suporte no (0,1). 

A comparação foi construída utilizando 6 métricas: AIC, BIC, CAIC, Kolmogorov-Smirnov, 
Cramer-Von Mises e Anderson-Darling, que se baseiam principalmente na verossimilhança.
A verossimilhança a considera os parâmetros variáveis, assim a função de verossimilhança indica os
parâmetros mais plausíveis de terem gerado a amostra. Logo, podemos verificar entre todas as 
distribuições quais possuem as maiores verossimilhanças, tendo assim os parâmetros mais plausíveis 
para a geração da amostra. No entanto, nota-se que todos os critérios contam outros elementos para 
a sua construção.  

```{python}
df['prop'] = np.where(df['prop'] >= 1, 0.99, df['prop'])
df['prop'] = np.where(df['prop'] <= 0, 0.01, df['prop'])
prop = df['prop']

kuma.fit(theta = [0.5, 1], data = prop,  change=True)

kuma.plot(prop)

kuma.metrics(prop)

```


\section{\centering Conclusão}


\section{\centering Referências}