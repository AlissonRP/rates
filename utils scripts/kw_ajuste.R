# João Inácio Scrimini - 201812400

rm(list=ls())

x <- c(0.22 , 0.17 , 0.11 , 0.10 , 0.15 , 0.06 , 0.05 , 0.07 , 0.12 , 0.09 , 0.23 , 0.25 , 0.23,		
       0.24 , 0.20 , 0.08 , 0.11 , 0.12 , 0.10 , 0.06 , 0.20 , 0.17 , 0.20 , 0.11 , 0.16 , 0.09,		
       0.10 , 0.12 , 0.12 , 0.10 , 0.09 , 0.17 , 0.19 , 0.21 , 0.18 , 0.26 , 0.19 , 0.17 , 0.18,		
       0.20 , 0.24 , 0.19 , 0.21 , 0.22 , 0.17 , 0.08 , 0.08 , 0.06 , 0.09 , 0.22 , 0.23 , 0.22,		
       0.19 , 0.27 , 0.16 , 0.28 , 0.11 , 0.10 , 0.20 , 0.12 , 0.15 , 0.08 , 0.12 , 0.09 , 0.14,		
       0.07 , 0.09 , 0.05 , 0.06 , 0.11 , 0.16 , 0.20 , 0.25 , 0.16 , 0.13 , 0.11 , 0.11 , 0.11,		
       0.08 , 0.22 , 0.11 , 0.13 , 0.12 , 0.15 , 0.12 , 0.11 , 0.11 , 0.15 , 0.10 , 0.15 , 0.17,		
       0.14 , 0.12 , 0.18 , 0.14 , 0.18 , 0.13 , 0.12 , 0.14 , 0.09 , 0.10 , 0.13 , 0.09 , 0.11,		
       0.11 , 0.14 , 0.07 , 0.07 , 0.19 , 0.17 , 0.18 , 0.16 , 0.19 , 0.15 , 0.07 , 0.09 , 0.17,		
       0.10 , 0.08 , 0.15 , 0.21 , 0.16 , 0.08 , 0.10 , 0.06 , 0.08 , 0.12 , 0.13)


# Função de densidade da kw ----------------------------------------------------

pdf_kw <- function(par,x){
  alpha = par[1]
  beta1 = par[2]
  f = alpha*beta1*x^(alpha-1)*(1-x^alpha)^(beta1-1)
  f
}

# Log-verossimilhança da kW ----------------------------------------------------

mlog_kw <- function(par,x){
  s <- sum(log(pdf_kw(par=par,x=x)))
  s
}

# KW ---------------------------------------------------------------------------

# library(maxLik)

par_kw <- c(2.3, 0.1) # chute inicial

maxi_kw <- summary(maxLik::maxLik(mlog_kw, start=par_kw, method= "SANN", x=x))
maxi_kw

EMV_kw <- maxLik::maxLik(mlog_kw, start=par_kw, method= "SANN", x=x)
EMV_kw$estimate

# ---------------------------------------------------------------------------- #

xx=seq(0.05,0.31,by=0.001)
hist(x,prob=T, ylim=c(0,8))
lines(xx,pdf_kw(EMV_kw$estimate,x=xx),type="l",lwd=3,lty=2, col=2)

# Simulated annealing - SANN - método de estimação


